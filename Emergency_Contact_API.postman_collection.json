{
  "info": {
    "name": "QR Vehicle Emergency System API - JWT-Only Collection",
    "description": "API collection for QR Vehicle Emergency System.\n\n**Authentication:**\n- Use a JWT with role: '1' (admin) for admin endpoints.\n- Use a JWT with role: '2' (user) for user endpoints.\n- Example Admin JWT payload:\n```json\n{\n  \"unique_name\": \"Balin Admin\",\n  \"role\": \"1\",\n  \"user_id\": \"2\",\n  \"parent_id\": \"1\",\n  \"time_zone\": \"05:30\",\n  \"nbf\": 1753093302,\n  \"exp\": 1753698102,\n  \"iat\": 1753093302\n}\n```\n- Example User JWT payload:\n```json\n{\n  \"unique_name\": \"torqdemo\",\n  \"role\": \"2\",\n  \"user_id\": \"10\",\n  \"parent_id\": \"2\",\n  \"time_zone\": \"Asia/Kolkata\",\n  \"nbf\": 1753102241,\n  \"exp\": 1753707041,\n  \"iat\": 1753102241\n}\n```\n\nSet the `auth_token` variable to your JWT for testing.",
    "version": "2.1.0",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{auth_token}}",
        "type": "string"
      }
    ]
  },
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Set common headers",
          "pm.request.headers.add({key: 'Content-Type', value: 'application/json'});"
        ]
      }
    }
  ],
  "variable": [
    { "key": "base_url", "value": "http://localhost:5000/api", "type": "string" },
    { "key": "auth_token", "value": "", "type": "string" },
    { "key": "qr_id", "value": "", "type": "string" },
    { "key": "device_id", "value": "", "type": "string" },
    { "key": "call_id", "value": "", "type": "string" }
  ],
  "item": [
    {
      "name": "Admin Flow (role: 1)",
      "item": [
        {
          "name": "Bulk Generate QR Codes",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{auth_token}}", "type": "text" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"count\": 100,\n  \"batchNumber\": \"BATCH_001\",\n  \"qrType\": \"sticker\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": { "raw": "{{base_url}}/admin/qr/bulk-generate", "host": ["{{base_url}}"], "path": ["admin", "qr", "bulk-generate"] }
          }
        },
        {
          "name": "Get QR Inventory",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{auth_token}}", "type": "text" }
            ],
            "url": { "raw": "{{base_url}}/admin/qr/inventory", "host": ["{{base_url}}"], "path": ["admin", "qr", "inventory"] }
          }
        },
        {
          "name": "Get QR Analytics",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{auth_token}}", "type": "text" }
            ],
            "url": { "raw": "{{base_url}}/admin/qr/analytics", "host": ["{{base_url}}"], "path": ["admin", "qr", "analytics"] }
          }
        },
        {
          "name": "Update QR Status",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Authorization", "value": "Bearer {{auth_token}}", "type": "text" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"suspended\",\n  \"reason\": \"Damaged\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": { "raw": "{{base_url}}/admin/qr/{{qr_id}}/status", "host": ["{{base_url}}"], "path": ["admin", "qr", "{{qr_id}}", "status"] }
          }
        },
        {
          "name": "Export QR Batch",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{auth_token}}", "type": "text" }
            ],
            "url": { "raw": "{{base_url}}/admin/qr/export/BATCH_001", "host": ["{{base_url}}"], "path": ["admin", "qr", "export", "BATCH_001"] }
          }
        }
      ]
    },
    {
      "name": "User Flow (role: 2)",
      "item": [
        {
          "name": "Get QR Info (Public)",
          "request": {
            "method": "GET",
            "url": { "raw": "{{base_url}}/qr/info/{{qr_id}}", "host": ["{{base_url}}"], "path": ["qr", "info", "{{qr_id}}"] }
          }
        },
        {
          "name": "Link QR to Device",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{auth_token}}", "type": "text" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"qrId\": \"{{qr_id}}\",\n  \"deviceInfo\": {\n    \"model\": \"GPS-2000\",\n    \"serialNumber\": \"SN123456789\"\n  },\n  // Optional: provide deviceId or let the system generate one\n  \"deviceId\": \"optional-device-id-here\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": { "raw": "{{base_url}}/qr/link", "host": ["{{base_url}}"], "path": ["qr", "link"] }
          }
        },
        {
          "name": "Get My Devices",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{auth_token}}", "type": "text" }
            ],
            "url": { "raw": "{{base_url}}/qr/my-devices", "host": ["{{base_url}}"], "path": ["qr", "my-devices"] }
          }
        },
        {
          "name": "Update Device Settings",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Authorization", "value": "Bearer {{auth_token}}", "type": "text" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"emergencyContacts\": [{\n    \"name\": \"Jane Doe\",\n    \"phone\": \"+1234567890\",\n    \"relationship\": \"spouse\",\n    \"priority\": 1\n  }],\n  \"autoAnswer\": true\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": { "raw": "{{base_url}}/qr/device/{{device_id}}/settings", "host": ["{{base_url}}"], "path": ["qr", "device", "{{device_id}}", "settings"] }
          }
        },
        {
          "name": "Unlink QR Code",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{auth_token}}", "type": "text" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reason\": \"Vehicle sold\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": { "raw": "{{base_url}}/qr/unlink/{{qr_id}}", "host": ["{{base_url}}"], "path": ["qr", "unlink", "{{qr_id}}"] }
          }
        },
        {
          "name": "Get Device Call History",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{auth_token}}", "type": "text" }
            ],
            "url": { "raw": "{{base_url}}/qr/device/{{device_id}}/calls", "host": ["{{base_url}}"], "path": ["qr", "device", "{{device_id}}", "calls"] }
          }
        }
      ]
    },
    {
      "name": "Anonymous Caller Flow",
      "item": [
        {
          "name": "Get QR Info (Public)",
          "request": {
            "method": "GET",
            "url": { "raw": "{{base_url}}/qr/info/{{qr_id}}", "host": ["{{base_url}}"], "path": ["qr", "info", "{{qr_id}}"] }
          }
        },
        {
          "name": "Initiate Emergency Call",
          "request": {
            "method": "POST",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"qrId\": \"{{qr_id}}\",\n  \"callType\": \"audio\",\n  \"callerInfo\": {\n    \"name\": \"Good Samaritan\",\n    \"phone\": \"+1911\",\n    \"location\": \"Interstate 95, Mile 42\",\n    \"description\": \"Vehicle breakdown, driver needs assistance\"\n  },\n  \"emergencyType\": \"breakdown\",\n  \"urgencyLevel\": \"medium\"\n}",
              "options": { "raw": { "language": "json" } }
            },
            "url": { "raw": "{{base_url}}/calls/initiate", "host": ["{{base_url}}"], "path": ["calls", "initiate"] }
          }
        }
      ]
    }
  ]
}